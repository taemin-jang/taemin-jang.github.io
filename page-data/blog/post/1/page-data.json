{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/post/1/","result":{"data":{"markdownRemark":{"html":"<h1>AJAX란?</h1>\n<p>AJAX (Asynchronous JavaScript And Xml)는 자바스크립트를 사용하여 브라우저가 서버에게 비동기 방식으로 데이터를 요청하고, 서버가 응답한 데이터를 수신하여 웹 페이지를 동적으로 갱신하는 프로그래밍 방식을 말한다.</p>\n<h2>AJAX 이전 전통적인 웹페이지 방식</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d99f28c1e0c4edbad2b86bfd42e84b8/940c5/web_before_ajax.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACk0lEQVR42oWU3WvTUBjG9y8LCk63Kei88UJU0IkKohcqKA4EvRAERVGmsk3nOrs1zWeTtGmaNmm+z/lJkk6nVn3h4ZyrH+c57/O+C2FSYgcZzrhRdQ/igqrkXMn6JHgN9i1w7jayb0O4zYIdpCj9Kd1BXEvpx1h+ClIihUDKQ9SRkiWYl6FzApTToCzBwTFw7rHgjjPUQYLm/ZQxTGjtK7W+tPY5UA3iXBClBVFaEiYpwrwB3TOgroJ6oYG6D/8Eql6COUzo9X2CKJ0BGlBcCNIS4jynNK9DdxnUc6CeB+UUuA/mAAcJ9ihlXk0mYzzPIxyPoHfjP8BB3GhmeRDm+NOi1jDKCRJBW+uxudthT9EQ1hooy8juOdDmAE0/wxjlteW/vTBNEhSli2XqYM9eaJwHffVXYNXdHcWppbhRHZ2qu4c60l6SJCFNohqYt5cY7Zwh3D2LOFiE/gxYxeb9dpt3W9/Y741xgox/laxiY68Rt07TebNI7+My5f4RYG15lGMGZf2Hlh/Tdx1cxybP0iaHUtSSQiLLDKzroK40lo3V3/8wRvNzVHeCOsqxvAhzb5PO5w0mPQXCAWXgICd9ZDhABhZSvwLdlTlNCRK6ARg7Wxjr19BfPqqbUkpJVpSUQvywWgpJIUCIAqouz4uNE0k0RaP15CbPN3U+Pb6D8+4ZIouRkY+YjijDISRj9L3PtLc/4KqtxvLcHE4KtJ7P7v1LbLx4xubT+9idNrLIEOkUmU0RaQxFSugP6Hz7St/szoK90sCq8atmuhq9yp4yLNA1E/PVOvrOFtZE1svh9ypFidv38H0PrKvQOdlAq5nuHG+WQzAt6skwgwIzAmMs8KP8X6FpDu8pGBebrVNJvwjjt3wH4pKddP2RFzEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AJAX 이전 전통적인 웹페이지 방식\"\n        title=\"\"\n        src=\"/static/5d99f28c1e0c4edbad2b86bfd42e84b8/0a47e/web_before_ajax.png\"\n        srcset=\"/static/5d99f28c1e0c4edbad2b86bfd42e84b8/8a4e8/web_before_ajax.png 150w,\n/static/5d99f28c1e0c4edbad2b86bfd42e84b8/5a46d/web_before_ajax.png 300w,\n/static/5d99f28c1e0c4edbad2b86bfd42e84b8/0a47e/web_before_ajax.png 600w,\n/static/5d99f28c1e0c4edbad2b86bfd42e84b8/940c5/web_before_ajax.png 772w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>클라이언트로부터 요청이 들어왔을 때 이전 웹 페이지와 차이가 없어 변경할 필요가 없는 부분도 포함해서 새로운 HTML을 서버로부터 다시 전송받는다.</li>\n<li>전송 받은 데이터를 처음부터 다시 렌더링한다. 이 때 화면 깜박임이 발생한다.</li>\n<li>클라이언트와 서버와 통신이 동기 방식으로 동작하여 서버로부터 응답이 될 때까지 블로킹된다.</li>\n</ol>\n<h2>AJAX 적용 후 웹페이지 방식</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d99f28c1e0c4edbad2b86bfd42e84b8/940c5/web_before_ajax.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACk0lEQVR42oWU3WvTUBjG9y8LCk63Kei88UJU0IkKohcqKA4EvRAERVGmsk3nOrs1zWeTtGmaNmm+z/lJkk6nVn3h4ZyrH+c57/O+C2FSYgcZzrhRdQ/igqrkXMn6JHgN9i1w7jayb0O4zYIdpCj9Kd1BXEvpx1h+ClIihUDKQ9SRkiWYl6FzApTToCzBwTFw7rHgjjPUQYLm/ZQxTGjtK7W+tPY5UA3iXBClBVFaEiYpwrwB3TOgroJ6oYG6D/8Eql6COUzo9X2CKJ0BGlBcCNIS4jynNK9DdxnUc6CeB+UUuA/mAAcJ9ihlXk0mYzzPIxyPoHfjP8BB3GhmeRDm+NOi1jDKCRJBW+uxudthT9EQ1hooy8juOdDmAE0/wxjlteW/vTBNEhSli2XqYM9eaJwHffVXYNXdHcWppbhRHZ2qu4c60l6SJCFNohqYt5cY7Zwh3D2LOFiE/gxYxeb9dpt3W9/Y741xgox/laxiY68Rt07TebNI7+My5f4RYG15lGMGZf2Hlh/Tdx1cxybP0iaHUtSSQiLLDKzroK40lo3V3/8wRvNzVHeCOsqxvAhzb5PO5w0mPQXCAWXgICd9ZDhABhZSvwLdlTlNCRK6ARg7Wxjr19BfPqqbUkpJVpSUQvywWgpJIUCIAqouz4uNE0k0RaP15CbPN3U+Pb6D8+4ZIouRkY+YjijDISRj9L3PtLc/4KqtxvLcHE4KtJ7P7v1LbLx4xubT+9idNrLIEOkUmU0RaQxFSugP6Hz7St/szoK90sCq8atmuhq9yp4yLNA1E/PVOvrOFtZE1svh9ypFidv38H0PrKvQOdlAq5nuHG+WQzAt6skwgwIzAmMs8KP8X6FpDu8pGBebrVNJvwjjt3wH4pKddP2RFzEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AJAX 적용 후 웹페이지 방식\"\n        title=\"\"\n        src=\"/static/5d99f28c1e0c4edbad2b86bfd42e84b8/0a47e/web_before_ajax.png\"\n        srcset=\"/static/5d99f28c1e0c4edbad2b86bfd42e84b8/8a4e8/web_before_ajax.png 150w,\n/static/5d99f28c1e0c4edbad2b86bfd42e84b8/5a46d/web_before_ajax.png 300w,\n/static/5d99f28c1e0c4edbad2b86bfd42e84b8/0a47e/web_before_ajax.png 600w,\n/static/5d99f28c1e0c4edbad2b86bfd42e84b8/940c5/web_before_ajax.png 772w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>변경할 부분을 갱신하는 데 필요한 데이터만 받기 때문에 불필요한 데이터 통신이 발생하지 않는다.</li>\n<li>변경할 필요가 없는 부분은 다시 렌더링하지 않는다. 화면 깜박임 현상이 발생하지 않는다.</li>\n<li>클라이언트와 서버의 통신이 비동기 방식으로 동작하므로 블로킹이 발생하지 않는다.</li>\n</ol>\n<h3>XMLHTTPRequest (XHR)</h3>\n<p>AJAX는 XMLHTTPRequest를 기반으로 동작하며, HTTP 비동기 통신을 위한 메서드와 프로퍼티를 제공한다.</p>\n<p>ES6 이전 방식</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"53614639973048980000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"복사했습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// 객체 생성\r\nvar ourRequest = new XMLHttpRequest();\r\n\r\n// HTTP 요청 정보 초기화\r\nourRequest.open(\r\n  &quot;GET&quot;,\r\n  &quot;https://taemin-jang.github.io/json-example/animals-1.json&quot;\r\n);\r\n\r\n// HTTP 요청이 성공적일 경우\r\nourRequest.onload = () => {\r\n  var ourData = JSON.parse(ourRequest.responseText);\r\n  console.log(ourData[0]);\r\n};\r\nourRequest.send();`, `53614639973048980000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">// 객체 생성\r\nvar ourRequest = new XMLHttpRequest();\r\n\r\n// HTTP 요청 정보 초기화\r\nourRequest.open(\r\n  &quot;GET&quot;,\r\n  &quot;https://taemin-jang.github.io/json-example/animals-1.json&quot;\r\n);\r\n\r\n// HTTP 요청이 성공적일 경우\r\nourRequest.onload = () =&gt; {\r\n  var ourData = JSON.parse(ourRequest.responseText);\r\n  console.log(ourData[0]);\r\n};\r\nourRequest.send();</code>\n        </deckgo-highlight-code>\n<h3>Fetch API</h3>\n<p>XMLHTTPRequest 보다 훨씬 코드가 직관적이다. Promise를 리턴한다.</p>\n<p>ES6 이후 방식</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"33211113457890140000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"복사했습니다.\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`fetch(&quot;https://taemin-jang.github.io/json-example/animals-1.json&quot;)\r\n\t.then(res => res.json())\r\n\t.then(resJson => console.log(resJson));\r\n\t.catch((error) => {\r\n        console.log(error);\r\n   });`, `33211113457890140000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">fetch(&quot;https://taemin-jang.github.io/json-example/animals-1.json&quot;)\r\n\t.then(res =&gt; res.json())\r\n\t.then(resJson =&gt; console.log(resJson));\r\n\t.catch((error) =&gt; {\r\n        console.log(error);\r\n   });</code>\n        </deckgo-highlight-code>\n<h2>정리</h2>\n<h3>장점</h3>\n<ul>\n<li>페이지를 전환하지 않고 빠르게 화면 일부분 업데이트 할 수 있다.</li>\n<li>수신하는 데이터 양을 줄일 수 있고 클라이언트에게 처리를 맡길 수 있다.</li>\n<li>서버 처리를 기다리지 않고 비동기 요청이 가능하다.</li>\n</ul>\n<h3>단점</h3>\n<ul>\n<li>지원하지 않는 브라우저가 있다.</li>\n<li>무분별하게 사용하면 역으로 서버의 부하가 늘어날 수 있다.</li>\n<li>동일 출처 정책 문제가 발생할 수 있다.</li>\n</ul>\n<h1>CORS, CSRF 그게 대체 모야?</h1>\n<p>CORS를 알기 전에 SOP 먼저 알고 가야한다.</p>\n<h2>SOP (Same-Origin Policy)</h2>\n<p>직역하면 동일 출처 정책이라고 한다. 말 그대로 같은 출처끼리 정보(리소스)를 공유할 수 있다.</p>\n<blockquote>\n<p>출처란 ?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/46a3b3abfac6599d1a4e9ea71234c5be/394f7/origin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVR42mWP6w6CMAxG9/7PqG4V0LEbF4OMbuMzQEKMNk3TnPbHdwT+a10BlHkq7+mXH6c457EHIDilhXlJ6exUCpfCRseK+OQ5p5y5lMWaSDLSjY0WLalgjFPSkbLyZuS1r++hrlyrdVO3pMz1YpX0pBxJS9K32jyaZ1WNXRAYOjAjOHQB3sK7bR96YEuI14jOb8TvD8Ej59ND8J7+kOFxWBN/Oa7HXPoQnc1x/uEfukkgBTVIv3QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"출처\"\n        title=\"\"\n        src=\"/static/46a3b3abfac6599d1a4e9ea71234c5be/0a47e/origin.png\"\n        srcset=\"/static/46a3b3abfac6599d1a4e9ea71234c5be/8a4e8/origin.png 150w,\n/static/46a3b3abfac6599d1a4e9ea71234c5be/5a46d/origin.png 300w,\n/static/46a3b3abfac6599d1a4e9ea71234c5be/0a47e/origin.png 600w,\n/static/46a3b3abfac6599d1a4e9ea71234c5be/394f7/origin.png 707w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Protocol + Host + Port를 출처라고 한다.</p>\n<p>이 중에서 하나라도 다르면 서로 다른 출처라고 브라우저에서 판단한다.</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>URL ( <a href=\"http://domain.com\">http://domain.com</a> )</th>\n<th>Result</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"http://domain.com:8080\">http://domain.com:8080</a></td>\n<td>x (port가 다르기 때문)</td>\n</tr>\n<tr>\n<td><a href=\"http://api.domain.com\">http://api.domain.com</a></td>\n<td>x (host가 다르기 때문)</td>\n</tr>\n<tr>\n<td><a href=\"https://domain.com\">https://domain.com</a></td>\n<td>x (protocol이 다르기 때문)</td>\n</tr>\n</tbody>\n</table>\n<p>이러한 정책은 <code>보안 이슈</code>로 인해 나오게 됐다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3eabf6b1c2acab95ac1a87a1c15b8e55/99f37/sop_issue.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVR42n1Tu24TURDdj+E3+AT+ACQKOhQpLRWKI0RDg0CK6BAFEhKGgkcR2lDEihWkKGuTxPuyd/furuN97965jxm0thSIEzOa5o7mzDlz7r0GEeEyNwUAZFlellWel2VZrfr1EmDgbWCuUGq0CzEp1eV8bp6NJ1PLmtqW7SiprtoMIvqaKrPVhKgEksIC9DiDBVdf3GrrZ0KEpS/SEV/85m0pieg0hWfHixy0waV6fBy9C7LyCEZvqvO90hnxSHXjvVJuHSREFB1w+33rfmzreVf/bFV3PnhBrYyoFXun7JN9iUCiQKxwUau3Z0XfbZ7/SneHCyLyB4X3rXa+F2XCieiI1TuHYcalMZ9fxiFLojgviuUiqIlO/MXh2DbjApC0Uixhw5Oh7TsgQAgRBgELGQAYQoim5S0HKeWVE6iVBI5ar45KaS+Mm4anaTqdzTjAX8Nuxsp8jbhKzDK4mAS+H0exBoFSagBEvB2stVZKaa07UiLo9fLt7ZqImkaYpjBNOZlsZO7IsaNv6tplrOr3aTDQRFpK5LzLpXLjJicR7e//ePnqdVEUQRC2bbs28dojuQ7ubvJF78mDe3dnPovixHGnjuNaEzsI2VqzcVOqkGp35+mjh/dt21FKnV9YtuM5rvevhI3gOE4sx/NmAWOR1v/5MrcZJqUEEFJIEGI1bm3VK/AfPSpQwB3KfEIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sop_issue\"\n        title=\"\"\n        src=\"/static/3eabf6b1c2acab95ac1a87a1c15b8e55/0a47e/sop_issue.png\"\n        srcset=\"/static/3eabf6b1c2acab95ac1a87a1c15b8e55/8a4e8/sop_issue.png 150w,\n/static/3eabf6b1c2acab95ac1a87a1c15b8e55/5a46d/sop_issue.png 300w,\n/static/3eabf6b1c2acab95ac1a87a1c15b8e55/0a47e/sop_issue.png 600w,\n/static/3eabf6b1c2acab95ac1a87a1c15b8e55/1cfc2/sop_issue.png 900w,\n/static/3eabf6b1c2acab95ac1a87a1c15b8e55/99f37/sop_issue.png 1100w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>만약 어떤 사이트를 방문했는데 해당 사이트가 누군가 악의적으로 만든 사이트라고 가정하자.</p>\n<p>해당 사이트에서 다른 금융 사이트를 로그인하도록 유도를 해서 로그인을 하면 악성 사이트에서 JS로 쉽게 접근하여 악의적으로 사용할 수 있다.</p>\n<p>이렇게 사용자의 인증된 세션을 악용해서 공격하는 방식을 CSRF (Cross Site Request Forgery, 사이트 간 위조 요청)라고 한다.</p>\n<p>CSRF를 방지하기 위해서 SOP 정책이 나오게 된 것이다. SOP를 적용하게 되면 악성 사이트의 Origin(출처)는 다른 출처이기 때문에 허용이 안된다.</p>\n<p>만약 다른 출처의 리소스를 접근하기 위해서 CORS 정책이 필요하다.</p>\n<h2>CORS (Cross-Origin Resource Sharing)</h2>\n<p>교차 출처 리소스 공유라고 직역이 되고, 교차 출처는 다른 출처를 의미한다.</p>\n<p>HTTP header를 추가하여 서로 다른 출처의 리소스를 접근할 수 있는 권한을 부여하도록 브라우저에게 알리는 정책이다.</p>\n<p>보안 상의 이유로 SOP에 의해 다른 출처의 HTTP 요청을 제한하지만, CORS 정책에 맞게 올바른 HTTP header를 포함한 응답을 반환하면 브라우저는 해당 출처에 대한 접근을 허용했다고 판단한다.</p>\n<h2>CORS 동작 방식</h2>\n<p>CORS 동작 방식에는 3가지 시나리오가 있다.</p>\n<ul>\n<li>Simple Request</li>\n<li>Preflight Request</li>\n<li>Request with Credentials</li>\n</ul>\n<h3>Simple Request</h3>\n<p>다음 모든 조건을 충족한다면 Preflight Request를 하지 않고 바로 요청을 보내는 것이다.</p>\n<ul>\n<li>HTTP Method : GET, HEAD, POST</li>\n<li>Header : Accept, Accept-Language, Content-Language, Content-Type</li>\n<li>Content-Type : application/x-www-form-urlencoded, multipart/form-data, text/plain</li>\n</ul>\n<p>CORS를 허용하려면 서버 측에서 Access-Control-Allow-Origin = ‘*’ 으로 해주면 모든 도메인을 허용해준다. ⇒ CORS 정책 위반 여부</p>\n<h3>Preflight Request</h3>\n<p>Simple Request와는 다르게 먼저 Option 메서드를 통해 다른 출처의 리소스로 HTTP 요청을 보낸 후 실제로 HTTP 요청을 전송하기 안전한지 확인한다. (사전 작업)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d0f12842e6256017883b73492981942e/2bef9/preflight_request.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVR42p2TW4/iMAyF+///JSuoqlYiFyd2YueySg0dBMwuM99DHhDHl+PT6c9OCKH33lrrH7Cu6/l8XpZlKqUw84cypdYqO1NrrdaqbbVE+x+llBhj733y3iMiACBiCAEAcs4iUmvVuk/03kMI8zwP8bquGKNzDgCcc95755y1Nu+UUo6GT5O31iZr7a1zHIzW3gNACIGIEMfPOeeUEhHlnFWsRadlWXSYH3HrbIw5nU5EVGstO697iggRCXNOiZnT/g5xa42IHlcaf0UkorRDRGqkEkK4Xq8ppWHYcSo9EjPHu39qnvfeuoE1JuxljDFEdBOXUh7FGoBSioiMWiEMI4MKR2fv/Zf494bp9towpSQib7PxFJLL5TI6b9uGiM5aY4zfSSmpXod/jaeIIOIQW2tjjHZHHTLGAIC6zcz/Gnvbtno/7/GKyEc7I6K1Vg1/zfDB49hf8ey9z/Occz4SJiI5Z2bWVymlENFYBzEAvAnJMVJKSb8qZtbbHh+c9/59SL4buNYKANcdPcrN7Q9DciysVunOfwGqPtA//sWyrQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Preflight Request\"\n        title=\"\"\n        src=\"/static/d0f12842e6256017883b73492981942e/0a47e/preflight_request.png\"\n        srcset=\"/static/d0f12842e6256017883b73492981942e/8a4e8/preflight_request.png 150w,\n/static/d0f12842e6256017883b73492981942e/5a46d/preflight_request.png 300w,\n/static/d0f12842e6256017883b73492981942e/0a47e/preflight_request.png 600w,\n/static/d0f12842e6256017883b73492981942e/1cfc2/preflight_request.png 900w,\n/static/d0f12842e6256017883b73492981942e/2bef9/preflight_request.png 1024w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Preflight Request : 헤더에 실제 요청 시 어떤 헤더와 HTTP Method를 사용할 지 전달\n<ul>\n<li>Access-Control-Request-Method : 실제 요청 시 전송 할 HTTP Method</li>\n<li>Access-Control-Request-Headers : 실제 요청 시 전송 할 정의된 헤더</li>\n</ul>\n</li>\n<li>Preflight Response : 사용 가능한 HTTP Method와 Header 목록을 전달\n<ul>\n<li>Access-Control-Allow-Origin : 리소스를 가져올 수 있는 출처, ( *로 할 경우 모든 출처를 허용)</li>\n<li>Access-Control-Allow-Methods : 리소스에 접근 시 허용되는 HTTP Method 목록</li>\n<li>Access-Control-Allow-Headers : 리소스에 접근 시 허용되는 정의된 헤더 목록</li>\n<li>Access-Control-Allow-Max-Age : Preflight Request에 대한 결과를 캐싱할 수 있는 시간\n<ul>\n<li>해당 시간 이내에 동일한 요청을 재시도 할 경우 Preflight Request를 생략하고 캐싱된 결과를 반환</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>이러한 Preflight Request 진행 후 CORS 정책에 위반되지 않으면 실제 요청을 통해 리소스에 접근하게 된다.</p>\n<h3>왜 Preflight Request를 하는걸까?</h3>\n<p>서버는 CORS를 모른다!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75c0a711211362f2cae18f419d0d4e18/66465/no_preflight.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABOklEQVR42n1Si3KEIAz0/3/yZtpeb84HWl88EtibRKTa2uIgE8JudgMVACQkXI16HHA3De6mvcyn/B1HldI1mQJSKvO/MydCFzw+ugaztb/A/TTira3xHHow84mEmPFpOtRDjxhjwVXMhNmueuBIKKunoDkb/AkUU9J4dQ7Wu5MItUxEBSDEgehbCVEpxDFqkRJn3NF6JT8BiaXFWty7FrfnA+O6IIQA55zmRMlzMLjVD5h51KI+54ryGDeFnBWJOk8EYioqtXfZouREZciqZS/muF+mA+HecJEv1WRmK0cFPy9tJ5Q2NOPXRqgg54AQxDvQDUBjAL/F5D2WdVXLZp7w3tbajtW70vu9j5tCsSpkskkMOL9NIY8RTKwKhmXW2U0j+nnS2xf1+2Xua7UzZ0/HF1uq/vWwr3IvXvxjNSxkoIQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"No Preflight\"\n        title=\"\"\n        src=\"/static/75c0a711211362f2cae18f419d0d4e18/0a47e/no_preflight.png\"\n        srcset=\"/static/75c0a711211362f2cae18f419d0d4e18/8a4e8/no_preflight.png 150w,\n/static/75c0a711211362f2cae18f419d0d4e18/5a46d/no_preflight.png 300w,\n/static/75c0a711211362f2cae18f419d0d4e18/0a47e/no_preflight.png 600w,\n/static/75c0a711211362f2cae18f419d0d4e18/1cfc2/no_preflight.png 900w,\n/static/75c0a711211362f2cae18f419d0d4e18/66465/no_preflight.png 1097w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>만약 Preflight를 안하게 됐을 때 Delete나 Put 같은 HTTP Method로 요청을 한다고 해보자.</p>\n<p>그러면 서버는 해당 요청대로 서버 로직을 처리한다. 이 때 데이터가 삭제될 수도 있고, 변경될 수도 있다. 그러고 서버에 CORS 설정을 안해줬으므로 허용된 출처는 없고 브라우저는 CORS 에러를 발생시킨다.</p>\n<p>하지만 이미 서버에서는 요청에 맞게 데이터를 처리한 이후다.</p>\n<p>그렇기 때문에 Preflight가 필요하게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/04eafcaf65fed43a1a6dd26233c82255/6acbf/preflight.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABUklEQVR42oVTa2+DMAzs//+B+7ytlQrlGULzjm+yAx0MtlmyROzcyXcOF/wT9Tjg/VHBeHfapyXXuOyaREcAEVLOp72zuIQYUQ09tDWMfgELUUI99qiGDuNTH/qUM9pJ4T50iClKTQi7SYkkynSYrNcTWjVitnY3JX/nnKGeMzqtEFMqhAJMab1VcgOSfowbS0rShjQtZC8PY4xS9MHj2j5w6xrcuhbWO3jvYZ0ToDYGn0ufZbI6a+33QFtCDhe8+NVohXroYZiICCEE6U/PGfXQoZ1GPMYePoTXhDtCkZRzSQYbC/gI8MVcCFdJDF4XsJW8J/Qe4GQvlAbdG0DNhTAEeOcwao1GDWLJ2/VDJPOy2JLzCYt2PgDE0yY502IJT+MXr3n77B9v9m/JLLVugaoBrhVgDMg5ROd+fcinhFyU58LE1pVkcvbzB+DsTxL8QvgFPSCwXGfJmI8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Preflight\"\n        title=\"\"\n        src=\"/static/04eafcaf65fed43a1a6dd26233c82255/0a47e/preflight.png\"\n        srcset=\"/static/04eafcaf65fed43a1a6dd26233c82255/8a4e8/preflight.png 150w,\n/static/04eafcaf65fed43a1a6dd26233c82255/5a46d/preflight.png 300w,\n/static/04eafcaf65fed43a1a6dd26233c82255/0a47e/preflight.png 600w,\n/static/04eafcaf65fed43a1a6dd26233c82255/1cfc2/preflight.png 900w,\n/static/04eafcaf65fed43a1a6dd26233c82255/6acbf/preflight.png 1001w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>위 그림과 같이 Preflight를 통해서 요청된 origin(출처)가 올바른지 확인 후 올바르지 않다면(=CORS) 서버에서는 어떠한 처리도 하지 않기 때문에 실제 요청을 보내지 않는다.</p>\n<h3>Request with Credentials</h3>\n<p>인증(쿠키) 관련 헤더를 포함할 때 사용하는 요청이다.</p>\n<ul>\n<li>클라이언트측 요청 헤더에 credentials 옵션을 별도로 설정해줘야 한다.\n<ul>\n<li>same-origin : 동일 출처 내에서만 인증 정보를 담는다. (기본값)</li>\n<li>include : 모든 요청에 대해서 인증 정보를 담는다.</li>\n<li>omit : 모든 요청에 대해서 인증 정보를 담을 수 없도록 설정한다.</li>\n</ul>\n</li>\n<li>서버측 응답 헤더에 Access-Control-Allow-Credentials 값이 반드시 true로 설정되어야 한다.\n<ul>\n<li>클라이언트측 요청 헤더에 credentials 옵션을 설정해줘도 서버측 응답 헤더에 설정해주지 않으면 인증 정보를 담지 못한다.</li>\n<li>또한 인증 정보를 허용한다면, Access-Control-Allow-Origin 헤더에 와일드카드 (*)는 넣을 수 없고, 반드시 출처를 지정해줘야한다.</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"AJAX 동작 원리 및 CSRF / CORS","slug":"blog/post/1","date":"2023년 08월 06일 ","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/04eafcaf65fed43a1a6dd26233c82255/3ff97/preflight.png","srcSet":"/static/04eafcaf65fed43a1a6dd26233c82255/90995/preflight.png 250w,\n/static/04eafcaf65fed43a1a6dd26233c82255/4ebff/preflight.png 501w,\n/static/04eafcaf65fed43a1a6dd26233c82255/3ff97/preflight.png 1001w","sizes":"(min-width: 1001px) 1001px, 100vw"},"sources":[{"srcSet":"/static/04eafcaf65fed43a1a6dd26233c82255/5c3ae/preflight.webp 250w,\n/static/04eafcaf65fed43a1a6dd26233c82255/6d9bc/preflight.webp 501w,\n/static/04eafcaf65fed43a1a6dd26233c82255/1420c/preflight.webp 1001w","type":"image/webp","sizes":"(min-width: 1001px) 1001px, 100vw"}]},"width":1001,"height":580}}},"profile":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/22942bf5ef783d654325396c0a1ddcad/53973/JangTaemin2.png","srcSet":"/static/22942bf5ef783d654325396c0a1ddcad/22867/JangTaemin2.png 8w,\n/static/22942bf5ef783d654325396c0a1ddcad/7961d/JangTaemin2.png 15w,\n/static/22942bf5ef783d654325396c0a1ddcad/53973/JangTaemin2.png 30w,\n/static/22942bf5ef783d654325396c0a1ddcad/7ab40/JangTaemin2.png 60w","sizes":"(min-width: 30px) 30px, 100vw"},"sources":[{"srcSet":"/static/22942bf5ef783d654325396c0a1ddcad/5d252/JangTaemin2.webp 8w,\n/static/22942bf5ef783d654325396c0a1ddcad/f57b3/JangTaemin2.webp 15w,\n/static/22942bf5ef783d654325396c0a1ddcad/bde72/JangTaemin2.webp 30w,\n/static/22942bf5ef783d654325396c0a1ddcad/927d1/JangTaemin2.webp 60w","type":"image/webp","sizes":"(min-width: 30px) 30px, 100vw"}]},"width":30,"height":30}}}}}},"pageContext":{"slug":"blog/post/1"}},"staticQueryHashes":["3159585216","3185596357"],"slicesMap":{}}